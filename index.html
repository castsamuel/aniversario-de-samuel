<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mensagens — Criado por Samuel</title>

<style>
    body {
        background-color: #000;
        color: #0f0;
        font-family: "Consolas", monospace;
        padding: 20px;
    }

    h1 {
        text-align: center;
        color: #0f0;
    }

    .card {
        border: 2px solid #0f0;
        padding: 15px;
        margin-top: 20px;
        border-radius: 10px;
    }

    input, textarea, button {
        width: 100%;
        margin-top: 10px;
        background: black;
        border: 1px solid #0f0;
        padding: 10px;
        color: #0f0;
        font-family: Consolas;
    }

    button:hover {
        cursor: pointer;
        opacity: 0.8;
    }

    /* TERMINAL */
    #terminal {
        display: none;
        margin-top: 30px;
        border: 2px solid #0f0;
        padding: 20px;
        border-radius: 10px;
    }

    #terminal-output {
        height: 200px;
        overflow-y: auto;
        background: #001100;
        padding: 10px;
        margin-bottom: 10px;
    }
</style>
</head>
<body>

<h1>Mensagens Secretas — Samuel</h1>

<div class="card">
    <h2>Enviar Mensagem</h2>
    <input id="sender" placeholder="Seu nome">
    <textarea id="message" placeholder="Sua mensagem" rows="4"></textarea>
    <button onclick="sendMessage()">Enviar</button>
    <p id="msg-status"></p>
</div>

<!-- TERMINAL SECRETO -->
<div id="terminal">
    <h2>Terminal Secreto</h2>
    <div id="terminal-output"></div>
    <input id="terminal-input" placeholder="Digite comandos">
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const supabaseUrl = "https://ptqiuuohfeytgumrmgvc.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB0cWl1dW9oZmV5dGd1bXJtZ3ZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ4NDg0MzYsImV4cCI6MjA4MDQyNDQzNn0.VjQdTF_4-bBtP02dR4NOSCqOU15NHtt6ttj8qE87rHE";

const supabase = supabase.createClient(supabaseUrl, supabaseKey);

/* ===========================
      ENVIAR SÓ UMA VEZ
=========================== */
async function sendMessage() {
    if (localStorage.getItem("enviado") === "true") {
        document.getElementById("msg-status").innerText =
            "Você já enviou uma mensagem.";
        return;
    }

    const sender = document.getElementById("sender").value;
    const message = document.getElementById("message").value;

    if (!sender || !message) {
        alert("Preencha tudo.");
        return;
    }

    const { error } = await supabase.from("mensagens").insert({
        sender: sender,
        message: message,
    });

    if (!error) {
        document.getElementById("msg-status").innerText =
            "Mensagem enviada!";
        document.getElementById("sender").value = "";
        document.getElementById("message").value = "";

        localStorage.setItem("enviado", "true");
    } else {
        document.getElementById("msg-status").innerText = "Erro ao enviar.";
    }
}

/* ===========================
      TERMINAL SECRETO
=========================== */

let buffer = "";
const terminal = document.getElementById("terminal");
const terminalInput = document.getElementById("terminal-input");
const terminalOutput = document.getElementById("terminal-output");

document.addEventListener("keydown", (e) => {
    buffer += e.key;

    if (buffer.includes("s4m4e4p4a4")) {
        terminal.style.display = "block";
        logTerminal("TERMINAL ATIVADO");
        buffer = "";
    }

    if (buffer.length > 20) buffer = buffer.slice(-20);
});

function logTerminal(text) {
    terminalOutput.innerHTML += text + "<br>";
    terminalOutput.scrollTop = terminalOutput.scrollHeight;
}

terminalInput.addEventListener("keydown", async (e) => {
    if (e.key === "Enter") {
        const cmd = terminalInput.value.trim();
        terminalInput.value = "";
        await runCommand(cmd);
    }
});

/* ===========================
       COMANDOS DO TERMINAL
=========================== */
async function runCommand(cmd) {
    if (cmd === "help") {
        logTerminal("Comandos: help, listar");
        return;
    }

    if (cmd === "listar") {

        const releaseTime = new Date("2024-12-22T00:00:00");
        const now = new Date();

        if (now < releaseTime) {
            logTerminal("⚠️ Visualização antecipada (modo teste).");
        }

        const { data, error } = await supabase
            .from("mensagens")
            .select("*");

        if (error) {
            logTerminal("Erro ao carregar mensagens.");
            return;
        }

        if (data.length === 0) {
            logTerminal("Nenhuma mensagem ainda.");
            return;
        }

        data.forEach((msg) => {
            logTerminal(`<b>${msg.sender}:</b> ${msg.message}`);
        });

        return;
    }

    logTerminal("Comando não reconhecido.");
}
</script>


</body>
</html>
